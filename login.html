<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Login â€“ Zeitmanagement</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ•’</text></svg>">
<style>
  :root{
    --bg:#f3f4f6;
    --panel:#ffffff;
    --text:#0b1220;
    --muted:#425066;
    --accent1:#28a745;
    --accent2:#3b82f6;
    --radius:12px;
    --shadow: 0 8px 24px rgba(15,23,42,0.06);
  }
  :root.dark{
    --bg:#0b0b0c;
    --panel:#0f1112;
    --text:#e8e8e8;
    --muted:#9aa0a6;
    --accent1:#ff4d4f;
    --accent2:#ff902b;
    --shadow: 0 8px 28px rgba(0,0,0,0.6);
  }

  *{box-sizing:border-box;}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:flex;justify-content:center;align-items:center;padding:20px;}
  
  .login-panel{background:var(--panel);padding:32px;border-radius:var(--radius);box-shadow:var(--shadow);width:100%;max-width:400px;display:flex;flex-direction:column;gap:16px;}
  h1{text-align:center;margin:0 0 12px 0;}
  input{padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);background:transparent;color:var(--text);width:100%;}
  button{padding:10px;border-radius:8px;border:none;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#fff;font-weight:600;cursor:pointer;}
  .error{color:#ff4d4f;font-size:0.9rem;text-align:center;display:none;}
  .centered{text-align:center;}
</style>
</head>
<body>
  <div class="login-panel">
    <h1>Zeitmanagement Login</h1>
    <form id="loginForm">
      <input type="text" id="username" placeholder="Benutzername" required />
      <input type="password" id="password" placeholder="Passwort" required />
      <button type="submit">Login</button>
    </form>
    <div class="error" id="loginError"></div>
  </div>

<script>
document.getElementById('loginForm').addEventListener('submit', async function(e){
  e.preventDefault();
  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value.trim();
  const errorEl = document.getElementById('loginError');
  errorEl.style.display = 'none';

  try {
    const res = await fetch('https://zeiterfassung-api.alessandrobolte.workers.dev/login', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ username, password })
    });

    const data = await res.json();

    if(res.ok && data.token){
      localStorage.setItem('zm:token', data.token);
      window.location.href = '/index.html';
    } else {
      errorEl.textContent = data.message || 'Login fehlgeschlagen. PrÃ¼fe Benutzername und Passwort.';
      errorEl.style.display = 'block';
    }
  } catch(err){
    console.error('Login-Fehler:', err);
    errorEl.textContent = 'Fehler beim Login. Verbindung zur API prÃ¼fen.';
    errorEl.style.display = 'block';
  }
});
</script>
</body>
</html>
