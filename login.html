<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Login - Zeitmanagement</title>
<link rel="stylesheet" href="style.css">
<style>
  :root {
    --bg: #f0f4f8;
    --panel: #ffffff;
    --text: #1f2937;
    --muted: #6b7280;
    --accent1: #4f46e5;
    --accent2: #6366f1;
    --radius: 16px;
    --shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  body {
    margin:0;
    font-family: 'Inter', sans-serif;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    background:var(--bg);
  }

  .login-panel {
    background:var(--panel);
    padding:40px 32px;
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    width:360px;
    display:flex;
    flex-direction:column;
    gap:16px;
  }

  .login-panel h2 {
    margin:0 0 16px 0;
    color:var(--text);
    text-align:center;
  }

  label {
    font-size:0.9rem;
    color:var(--muted);
  }

  input {
    padding:12px;
    border-radius:12px;
    border:1px solid rgba(0,0,0,0.1);
    background:transparent;
    color:var(--text);
    width:100%;
    font-size:1rem;
  }

  button {
    padding:12px;
    border-radius:16px;
    border:none;
    background: linear-gradient(90deg,var(--accent1),var(--accent2));
    color:#fff;
    font-weight:600;
    font-size:1rem;
    cursor:pointer;
    transition: transform 0.15s ease, box-shadow 0.15s ease;
  }

  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0,0,0,0.15);
  }

  .error {
    color:#ef4444;
    font-size:0.9rem;
    height:1.2em;
    text-align:center;
  }
</style>
</head>
<body>
  <div class="login-panel">
    <h2>Login</h2>
    <div class="error" id="errorMsg"></div>
    <label for="username">Benutzername</label>
    <input type="text" id="username" autocomplete="username" placeholder="Benutzername">
    <label for="password">Passwort</label>
    <input type="password" id="password" autocomplete="current-password" placeholder="Passwort">
    <button id="loginBtn">Einloggen</button>
  </div>

<script>
const loginBtn = document.getElementById('loginBtn');
const errorMsg = document.getElementById('errorMsg');

loginBtn.addEventListener('click', async () => {
    errorMsg.textContent = '';
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value;

    if(!username || !password){
        errorMsg.textContent = 'Bitte alle Felder ausf√ºllen';
        return;
    }

    try {
        const res = await fetch('https://zeiterfassung-api.alessandrobolte.workers.dev', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ username, password })
        });

        if(!res.ok){
            const text = await res.text();
            errorMsg.textContent = text || 'Login fehlgeschlagen';
            return;
        }

        const data = await res.json();

        if(data.token){
            localStorage.setItem('token', data.token);

            if(data.role === 'admin'){
                window.location.href = 'admin.html';
            } else {
                window.location.href = 'index.html';
            }
        } else {
            errorMsg.textContent = data.message || 'Login fehlgeschlagen';
        }

    } catch(e){
        console.error(e);
        errorMsg.textContent = 'Server nicht erreichbar';
    }
});
</script>
</body>
</html>
